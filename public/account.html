<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account - Pixel Domination</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    <header>
        <img src="images/logo.png" alt="Pixel Domination Logo" class="logo">
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a href="how-to-play.html">How to Play</a></li>
                <li><a href="community.html">Community</a></li>
                <li><a href="marketplace.html">Marketplace</a></li>
                <li><a href="news.html">News</a></li>
                <li><a href="contact.html">Contact Us</a></li>
                <li><a href="account.html">Account</a></li>
            </ul>
        </nav>
        <button id="logout-button" style="display:none;">Log Out</button>
    </header>

    <main>
        <section class="account">
            <h1>Account Details</h1>
            <div id="user-details">
                <p>Please log in to view your account details.</p>
            </div>
            <div class="form-container" id="login-form-container">
                <form id="login-form" style="display:none;">
                    <label for="username">Username:</label>
                    <input type="text" id="username" name="username" required>

                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" required>

                    <button type="submit">Log In</button>
                </form>
                <div class="links" style="display:none;">
                    <a href="#" id="radix-login">Login with Radix Wallet</a>
                    <a href="#" id="google-login">Login with Google</a>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Pixel Domination. All rights reserved.</p>
        <a href="privacy.html">Privacy Policy</a> | <a href="terms.html">Terms of Service</a>
    </footer>

    <script>
        // Initialize Netlify Identity
        netlifyIdentity.init();

        // Check if the user is logged in
        const user = netlifyIdentity.currentUser();
        if (user) {
            document.getElementById('user-details').innerHTML = `
                <p><strong>Username:</strong> ${user.user_metadata.full_name}</p>
                <p><strong>Email:</strong> ${user.email}</p>
            `;
            document.getElementById('logout-button').style.display = 'block';
        } else {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('login-form-container').querySelector('.links').style.display = 'block';
        }

        // Add event listener to login button
        document.getElementById('google-login').addEventListener('click', () => {
            netlifyIdentity.open('login');
        });

        // Listen for login event
        netlifyIdentity.on('login', user => {
            console.log('Logged in user:', user);
            document.getElementById('user-details').innerHTML = `
                <p><strong>Username:</strong> ${user.user_metadata.full_name}</p>
                <p><strong>Email:</strong> ${user.email}</p>
            `;
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('login-form-container').querySelector('.links').style.display = 'none';
            document.getElementById('logout-button').style.display = 'block';
        });

        // Listen for logout event
        netlifyIdentity.on('logout', () => {
            console.log('User logged out');
            document.getElementById('user-details').innerHTML = '<p>Please log in to view your account details.</p>';
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('login-form-container').querySelector('.links').style.display = 'block';
            document.getElementById('logout-button').style.display = 'none';
        });

        // Radix DLT Wallet Login
        document.getElementById('radix-login').addEventListener('click', async (e) => {
            e.preventDefault();
            try {
                // Example Radix DLT login process
                const wallet = await RadixDLT.wallet();
                const account = await wallet.connect();
                document.getElementById('user-details').innerHTML = `
                    <p><strong>Wallet Address:</strong> ${account.address}</p>
                    <p><strong>Balance:</strong> ${account.balance}</p>
                `;
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('login-form-container').querySelector('.links').style.display = 'none';
                document.getElementById('logout-button').style.display = 'block';
            } catch (error) {
                console.error('Radix DLT login failed:', error);
            }
        });

        // Add event listener to logout button
        document.getElementById('logout-button').addEventListener('click', () => {
            netlifyIdentity.logout();
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>
